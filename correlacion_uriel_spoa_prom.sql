SELECT
  u.YYYY,
  (
    AVG(p.PIB * u.TOTAL_DEL_PROM) - (AVG(p.PIB) * AVG(u.TOTAL_DEL_PROM))
  ) / (STD(p.PIB) * STD(u.TOTAL_DEL_PROM)) AS 'Pearson'
FROM
  uriel_spoa u
  LEFT JOIN pib p ON (
    u.DPTO = p.DPTO
    AND u.MPIO = p.MPIO
    AND u.YYYY = p.YYYY
  )
GROUP BY
  u.YYYY
ORDER BY
  YYYY ASC;
  /* RESULTADOS
   2014	0.8776609799267008
   2015	0.7574930618238054
   2016	0.22671532344379783
   2017	0.3117843749129327
   2018	0.9459566635295175
   2019	0.8772359242406592
   */
SELECT
  u.YYYY,
  (
    AVG(p.VALOR * u.TOTAL_DEL_PROM) - (AVG(p.VALOR) * AVG(u.TOTAL_DEL_PROM))
  ) / (STD(p.VALOR) * STD(u.TOTAL_DEL_PROM)) AS 'Pearson'
FROM
  uriel_spoa u
  LEFT JOIN participaciones p ON (
    u.DPTO = p.DPTO
    AND u.MPIO = p.MPIO
    AND u.YYYY = p.YYYY
  )
GROUP BY
  u.YYYY
ORDER BY
  YYYY ASC;
  /* RESULTADOS
   2014	0.901389166781959
   2015	0.7929549017293959
   2016	0.20980219301518607
   2017	0.30402688220955953
   2018	0.9570433203263673
   2019	0.8532993774971219
   */
SELECT
  u.YYYY,
  (
    AVG(r.VALOR * u.TOTAL_DEL_PROM) - (AVG(r.VALOR) * AVG(u.TOTAL_DEL_PROM))
  ) / (STD(r.VALOR) * STD(u.TOTAL_DEL_PROM)) AS 'Pearson'
FROM
  uriel_spoa u
  LEFT JOIN regalias r ON (
    u.DPTO = r.DPTO
    AND u.MPIO = r.MPIO
    AND u.YYYY = r.YYYY
  )
GROUP BY
  u.YYYY
ORDER BY
  YYYY ASC;
  /* RESULTADOS
   2014	0.08025063970399246
   2015	0.1376529111265155
   2016	0.012906975425867108
   2017	0.10223248283286991
   2018	0.13571528719420942
   2019	0.16089660118929808
   */