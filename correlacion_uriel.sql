SELECT u.YYYY,
    (
        AVG(p.PIB * u.DEL_ELECT) - (AVG(p.PIB) * AVG(u.DEL_ELECT))
    ) / (STD(p.PIB) * STD(u.DEL_ELECT)) AS 'Pearson'
FROM uriel u
    LEFT JOIN pib p ON (
        u.DPTO = p.DPTO
        AND u.MPIO = p.MPIO
        AND u.YYYY = p.YYYY
    )
GROUP BY u.YYYY
ORDER BY YYYY ASC;
/* RESULTADOS
 2014	0.8908202330072044
 2015	0.8051093003221728
 2016	0.03954696077489952
 2017	0.10736097093437544
 2018	0.9547100889382497
 2019	0.9015587017215744
 */
SELECT u.YYYY,
    (
        AVG(p.VALOR * u.DEL_ELECT) - (AVG(p.VALOR) * AVG(u.DEL_ELECT))
    ) / (STD(p.VALOR) * STD(u.DEL_ELECT)) AS 'Pearson'
FROM uriel u
    LEFT JOIN participaciones p ON (
        u.DPTO = p.DPTO
        AND u.MPIO = p.MPIO
        AND u.YYYY = p.YYYY
    )
GROUP BY u.YYYY
ORDER BY YYYY ASC;
/* RESULTADOS
 2014	0.9114030805547786
 2015	0.802920228336272
 2016	0.011579190247040717
 2017	0.09924861259009381
 2018	0.9621876635452825
 2019	0.867335366686995
 */
SELECT u.YYYY,
    (
        AVG(r.VALOR * u.DEL_ELECT) - (AVG(r.VALOR) * AVG(u.DEL_ELECT))
    ) / (STD(r.VALOR) * STD(u.DEL_ELECT)) AS 'Pearson'
FROM uriel u
    LEFT JOIN regalias r ON (
        u.DPTO = r.DPTO
        AND u.MPIO = r.MPIO
        AND u.YYYY = r.YYYY
    )
GROUP BY u.YYYY
ORDER BY YYYY ASC;
/* RESULTADOS
 2014	0.07839630852225889
 2015	0.13532033960612477
 2016	0.046466714760077604
 2017	-0.005778259932724814
 2018	0.13948431309665157
 2019	0.15960683418777996
 */
SELECT hv.YYYY,
    (
        AVG(hv.HECHOS * c.TOTAL_HA) - (AVG(hv.HECHOS) * AVG(c.TOTAL_HA))
    ) / (STD(hv.HECHOS) * STD(c.TOTAL_HA)) AS 'Pearson'
FROM cultivos_ilicitos c
    LEFT JOIN hechos_victimizantes hv ON (
        c.DPTO = hv.DPTO
        AND c.MPIO = hv.MPIO
        AND c.YYYY = hv.YYYY
    )
GROUP BY hv.YYYY
ORDER BY YYYY ASC;
/* RESULTADOS
 2014	0.458974804091106
 2015	0.6899571567387583
 2016	0.4760389142391717
 2017	0.5169938080603204
 2018	0.38866078111309027
 2019	0.27717001806452846
 */
-- URIEL con PIB < 1000
 SELECT u.YYYY,
    (
        AVG(p.PIB * u.DEL_ELECT) - (AVG(p.PIB) * AVG(u.DEL_ELECT))
    ) / (STD(p.PIB) * STD(u.DEL_ELECT)) AS 'Pearson'
FROM uriel u
    LEFT JOIN pib p ON (
        u.DPTO = p.DPTO
        AND u.MPIO = p.MPIO
        AND u.YYYY = p.YYYY
    )
WHERE  p.PIB <= 1000 AND u.YYYY NOT IN (2016,2017)
GROUP BY u.YYYY
ORDER BY YYYY ASC;